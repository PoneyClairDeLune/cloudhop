"use strict";let eG=(a,b="")=>{return process.env[a]||b};let pV="DigitalOcean",pE=process.exit.bind();let self=globalThis;let pP=true;Object.forEach=function(t,o){Object.keys(t).forEach(function(e){o(t[e],e,t)})};var a=function(t,o){let r=new Set;return o?.length>0&&o.forEach(function(e){e.length>0&&r.add(e.toLowerCase())}),t.forEach(function(e){e.length>0&&r.add(e.toLowerCase())}),r},s=function(t,o){let r={};return Object.forEach(o||{},function(e,i){r[i.toLowerCase()]=e}),t.split(",").forEach(function(e){let i=e.indexOf("=");i<e.length-1&&(r[e.slice(0,i).toLowerCase()]=e.slice(i+1))}),r};String.prototype.has=String.prototype.includes;Array.prototype.has=Array.prototype.includes;self.pW="0.3";Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};Array.prototype.draw=function(){return this.splice(Math.floor(Math.random()*this.length),1)};var l=eG("DEBUGGER","0")=="1",d=eG("BACKENDS","internal").split(","),P=eG("BACKHOST",""),f=eG("MASK_IP","strip"),h=eG("MASK_UA","noBracket"),G=eG("FOLLOW_REDIR","0"),p=eG("FORCE_IN_TLS","asIs"),u=eG("FORCE_OUT_TLS","asIs"),_=eG("ADAPT_BODY","0")=="1",g=eG("MATCH_LANG","*").split(","),w=Math.max(parseInt(eG("HEALTH_MAX_TRIES","3")),1),c=pP?parseFloat(eG("HEALTH_ACTIVE","5")):0,m=eG("HEALTH_PATH"),b=eG("HEALTH_CRITERIA","asIs"),x=Math.max(parseInt(eG("TIMEOUT_MS","0")),2500),D=a(eG("STRIP_HEADERS_UP","").split(","),"host,cf-connecting-ip,cdn-loop,cf-ew-via,cf-visitor,cf-ray,x-forwarded-for,x-real-ip,x-requested-with,accept-language,te,user-agent,sec-ch-lang,sec-ch-save-data,sec-ch-prefers-color-scheme,sec-ch-prefers-reduced-motion,sec-ch-prefers-reduced-transparency,sec-ch-prefers-contrast,sec-ch-forced-colors,sec-ch-ua-full-version,sec-ch-ua-full-version-list,sec-ch-ua-platform-version,sec-ch-ua-arch,sec-ch-ua-bitness,sec-ch-ua-wow64,sec-ch-ua-model,viewport-width,viewport-height,dpr,device-memory,rtt,downlink,ect,sec-ch-viewport-width,sec-ch-viewport-height,sec-ch-dpr,sec-ch-device-memory,sec-ch-rtt,sec-ch-downlink,sec-ch-ect".split(",")),U=a(eG("STRIP_HEADERS","").split(","),["alt-svc","content-encoding","strict-transport-security"]),W=s(eG("SET_HEADERS_UP",""),{"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin"}),F=s(eG("SET_HEADERS","")),n=parseInt(eG("IDLE_SHUTDOWN","0"));n>0?n=Math.max(n,60)*1e3:n=-1;console.info(`Debug: ${l?"on":"off"}`);console.info(`Backends: ${d}`);console.info(`Mask: UA(${h}), IP(${f}), lang(${g})`);console.info(`TLS: in(${p}), out(${u});`);console.info(`Health: active(${c}), tries(${w}), crit(${b}), timeout(${x}ms), path(${m})`);console.info(`Inactivity shutdown: ${n}`);var y=Date.now();pP&&(console.info("Platform persistence available."),n>0&&setInterval(function(){Date.now()-y>n&&(console.info("Requested idle shutdown."),pE())},1e3),c>0&&console.info("Active health checking enabled, but not implemented."));
